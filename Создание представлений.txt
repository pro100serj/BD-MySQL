CREATE VIEW PRINTED_MATERIALS_TOP AS SELECT NUMBER_OF_ISSUE, RNK, PRINTED_MATERIALS_ID, PRINTED_MATERIALS.NAME 
FROM (SELECT PRINTED_MATERIALS_ID, DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS RNK, COUNT(*) AS NUMBER_OF_ISSUE 
FROM USER_OF_PRINTED_MATERIALS GROUP BY PRINTED_MATERIALS_ID) T1
JOIN PRINTED_MATERIALS ON PRINTED_MATERIALS.ID=T1.PRINTED_MATERIALS_ID
WHERE RNK <11;

CREATE VIEW USERS_TOP AS SELECT NUMBER_OF_ISSUE, RNK, USERS.ID, USERS.FULL_NAME, DATE_AND_TIME_OF_ISSUE 
FROM (SELECT USER_ID, DATE_AND_TIME_OF_ISSUE,  DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS RNK, COUNT(*) AS NUMBER_OF_ISSUE 
FROM USER_OF_PRINTED_MATERIALS GROUP BY USER_ID, DATE_AND_TIME_OF_ISSUE) T1
JOIN USERS ON USERS.ID=T1.USER_ID
WHERE (T1.DATE_AND_TIME_OF_ISSUE BETWEEN '14.05.2005' AND '19.08.2010') AND RNK <11;

CREATE VIEW ALL_BOOK AS SELECT USERS.ID AS USER_ID, PRINTED_MATERIALS.NUMBER_OF_COPIES, PRINTED_MATERIALS.ID AS PRINTED_MATERIALS_ID, PRINTED_MATERIALS.NAME, USERS.FULL_NAME
FROM USERS CROSS JOIN PRINTED_MATERIALS
WHERE PRINTED_MATERIALS.NUMBER_OF_COPIES>1 AND USERS.ID NOT IN(SELECT USER_ID FROM BLACK_LIST);